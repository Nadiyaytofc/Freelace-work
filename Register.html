<!DOCTYPE html>
<html lang="si">
<head>
  <meta charset="utf-8">
  <title>Registration Form - Freelance Work</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <style>
    body { background-color: #0b1220; color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 15px; position: relative; padding-bottom: 80px; }
    .container { max-width: 750px; margin: 0 auto; }
    
    .home-btn { position: absolute; top: 15px; right: 15px; background: #38bdf8; color: #000; padding: 8px 18px; border-radius: 20px; text-decoration: none; font-weight: bold; font-size: 0.9rem; transition: 0.3s; z-index: 100; }
    .home-btn:hover { background: #fff; }

    .notice-card { background: rgba(15, 23, 42, 0.8); border: 1px solid #1e293b; border-radius: 15px; padding: 20px; margin-bottom: 25px; border-left: 5px solid #38bdf8; margin-top: 60px; }
    .notice-card h3 { color: #38bdf8; margin-top: 0; font-size: 1.1rem; }
    .notice-list { font-size: 0.85rem; color: #cbd5e1; padding-left: 20px; }
    .notice-list li { margin-bottom: 5px; }

    .form-wrapper { background: #fff; color: #334155; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
    .tabs { display: flex; background: #000; padding: 5px; border-radius: 12px; margin-bottom: 20px; }
    .tab { flex: 1; text-align: center; color: white; padding: 8px; font-size: 0.7rem; border-radius: 8px; }
    .active-tab { background: #38bdf8; color: black; font-weight: bold; }
    
    label { display: block; margin-top: 15px; font-weight: bold; font-size: 0.85rem; color: #000; }
    input, select { width: 100%; padding: 12px; margin-top: 5px; border: 1px solid #cbd5e1; border-radius: 8px; box-sizing: border-box; font-size: 0.9rem; color: #000; }
    .btn-register { background: #1d4ed8; color: white; width: 100%; padding: 16px; border: none; border-radius: 30px; font-weight: bold; font-size: 1rem; margin-top: 25px; cursor: pointer; transition: 0.3s; }
    .btn-register:hover { background: #2563eb; }
    
    .error-section { margin-top: 30px; background: #0f172a; border-radius: 15px; padding: 15px; border: 1px solid #334155; margin-bottom: 20px; }
    .error-section h4 { color: #ef4444; margin-top: 0; }
    table { width: 100%; border-collapse: collapse; font-size: 0.8rem; color: #fff; }
    th, td { border: 1px solid #1e293b; padding: 10px; text-align: left; }
    th { background: #1e293b; color: #38bdf8; }

    footer { position: fixed; bottom: 0; left: 0; width: 100%; background: #0f172a; text-align: center; padding: 15px 0; border-top: 1px solid #1e293b; font-size: 0.8rem; color: #64748b; z-index: 99; }

    #success-screen { display: none; text-align: center; padding: 50px 20px; background: #fff; color: #000; border-radius: 20px; }
    .member-id { font-size: 1.8rem; font-weight: 900; color: #1d4ed8; margin: 20px 0; letter-spacing: 2px; }
  </style>
</head>
<body>

<div class="container">
  <a href="index.html" class="home-btn"> Home</a>

  <div class="notice-card">
    <h3>කළ යුතු සහ නොකළ යුතු දේ (Notice)</h3>
    <ul class="notice-list">
      <li>✅ සැමවිටම ඔබේ සත්‍ය නම සහ නිවැරදි NIC අංකය ඇතුළත් කරන්න.</li>
      <li>✅ ක්‍රියාකාරී WhatsApp අංකයක් ලබාදීමට කාරුණික වන්න.</li>
      <li>❌ වැරදි තොරතුරු ඇතුළත් කළහොත් ලියාපදිංචිය අවලංගු වේ.</li>
      <li>❌ එකම තොරතුරු භාවිතා කර කිහිප වතාවක් ලියාපදිංචි නොවන්න.</li>
    </ul>
  </div>

  <div class="form-wrapper" id="main-form">
    <div class="tabs">
        <div class="tab active-tab">Register<br>Form</div>
        <div class="tab" style="background: #1e293b;">Members<br>ID</div>
        <div class="tab" style="background: #1e293b;">Wallet<br>Profile</div>
    </div>

    <h2 style="color: #000;">Register as a Freelancer</h2>
    
    <form id="freelancerForm">
        <label>NIC (හැඳුනුම්පත් අංකය)</label>
        <input type="text" id="nic" placeholder="උදා: 19XXXXXXXXXX" required>

        <label>Real Name (සැබෑ නම)</label>
        <input type="text" id="fullname" placeholder="ඔබේ සම්පූර්ණ නම" required>

        <label>WhatsApp No</label>
        <input type="tel" id="whatsapp" placeholder="07XXXXXXXX" required>

        <label>District (දිස්ත්‍රික්කය)</label>
        <select id="district" required>
          <option value="">-- තෝරන්න --</option>
          <option>Colombo</option><option>Gampaha</option><option>Kalutara</option><option>Kandy</option><option>Matale</option><option>Nuwara Eliya</option><option>Galle</option><option>Matara</option><option>Hambantota</option><option>Jaffna</option><option>Kilinochchi</option><option>Mannar</option><option>Vavuniya</option><option>Mullaitivu</option><option>Batticaloa</option><option>Ampara</option><option>Trincomalee</option><option>Kurunegala</option><option>Puttalam</option><option>Anuradhapura</option><option>Polonnaruwa</option><option>Badulla</option><option>Moneragala</option><option>Ratnapura</option><option>Kegalle</option>
        </select>

        <button type="submit" id="submitBtn" class="btn-register">Register Now</button>
    </form>
  </div>

  <div id="success-screen">
    <div style="font-size: 50px; color: #22c55e;">✔</div>
    <h1 style="color: #22c55e;">Success!</h1>
    <p>ලියාපදිංචිය සාර්ථකයි. ඔබේ ID එක:</p>
    <div class="member-id" id="m-id"></div>
    <button class="btn-register" onclick="window.location.href='index.html'">Back to Home</button>
  </div>

  <div class="error-section">
    <h4>ලියාපදිංචි වීමේදී ඇතිවන ගැටළු (Solutions)</h4>
    <table>
      <tr>
        <th>ගැටළුව (Error)</th>
        <th>පිළියම (Solution)</th>
      </tr>
      <tr>
        <td>දත්ත යැවීමේදී දෝෂයක් ඇති වීම</td>
        <td>අන්තර්ජාල සම්බන්ධතාවය පරීක්ෂා කර නැවත උත්සාහ කරන්න.</td>
      </tr>
      <tr>
        <td>ID අංකය දිස් නොවීම</td>
        <td>පිටුව Refresh කර නැවත තොරතුරු ඇතුළත් කරන්න.</td>
      </tr>
    </table>
  </div>
</div>

<footer>
  &copy; 2025 Freelance work- All Rights Reserved.
</footer>

<script>
  const form = document.getElementById('freelancerForm');
  const submitBtn = document.getElementById('submitBtn');
  const SHEETDB_URL = 'https://sheetdb.io/api/v1/75frytfjpik0e'; 
  const FORMSPREE_URL = 'https://formspree.io/f/meeqqlwl';

  form.onsubmit = async (e) => {
    e.preventDefault();
    
    // බටන් එක Disable කිරීම (වැරදීමකින් දෙපාරක් එබීම වැලැක්වීමට)
    submitBtn.innerText = "Processing...";
    submitBtn.disabled = true;

    const randomID = "FL" + Math.floor(100000 + Math.random() * 900000);
    
    const sheetData = {
      "NIC_Number": document.getElementById('nic').value,
      "Full_Name": document.getElementById('fullname').value,
      "WhatsApp_No": document.getElementById('whatsapp').value,
      "District": document.getElementById('district').value,
      "Member_ID": randomID
    };

    try {
      // 1. SheetDB වෙත දත්ත යැවීම
      await fetch(SHEETDB_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ data: [sheetData] })
      });

      // 2. Formspree වෙත දත්ත යැවීම
      await fetch(FORMSPREE_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
        body: JSON.stringify(sheetData)
      });

      // සාර්ථක වූ පසු
      document.getElementById('m-id').innerText = randomID;
      document.getElementById('main-form').style.display = 'none';
      document.getElementById('success-screen').style.display = 'block';
      window.scrollTo(0,0);
      
    } catch (error) {
      alert("අන්තර්ජාල සම්බන්ධතාවයේ ගැටලුවක්! කරුණාකර නැවත උත්සාහ කරන්න.");
      submitBtn.innerText = "Register Now";
      submitBtn.disabled = false;
    }
  };
</script>

</body>
      </html>
